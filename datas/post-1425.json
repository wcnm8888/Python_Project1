{
    "link": "https://bbs.nga.cn/read.php?tid=39493013",
    "title": "类似手机令牌的那种验证码怎么实现的",
    "post_time": "2024-03-06 12:26",
    "uid": "62855938",
    "content": "steam手机令牌",
    "replies": [
        {
            "mid": "63453772",
            "mtime": "2024-03-06 12:44",
            "mcontent": "脑补一下，随机数生成器+加密？我记得用处理器噪音可以生成真随机来着"
        },
        {
            "mid": "1781995",
            "mtime": "2024-03-06 12:47",
            "mcontent": "初始化时要导入一串token字符串，后续服务端和客户端都依赖token和时间戳进行生成和校验，所以即使不联网也能用"
        },
        {
            "mid": "42252406",
            "mtime": "2024-03-06 14:32",
            "mcontent": "2楼对的。本质服务器和本地在相同时间戳下面算同一个东西。第一次从服务器同步的时候包括了元数据与算法"
        },
        {
            "mid": "65171953",
            "mtime": "2024-03-06 17:15",
            "mcontent": "[https:://blog.chrxw.com/archives/2021/04/04/1557.html 此网页不属于本网站，不保证其安全性  继续访问       取消 https://blog.chrxw.com/archives/2021/04/04/1557.html https://blog.chrxw.com/archives/2021/04/04/1557.html]本质跟totp验证器没有区别，都是服务器和客户端事先商量好一个secret，然后根据时间戳/步长(一般是30秒)，就是说时间差不超过30秒算出来的结果一样，然后用算法，一般是hmac计算出一个结果，16进制转10进制，然后取前6位就是普通的6位2fa了，Steam最后多了一步十六进制转ascii"
        },
        {
            "mid": "62855938",
            "mtime": "2024-03-06 17:49",
            "mcontent": "感谢，原来这个东西叫otp"
        },
        {
            "mid": "65171953",
            "mtime": "2024-03-06 18:30",
            "mcontent": "分两种，hotp和totp，一个基于网络一个基于时间"
        },
        {
            "mid": "24896125",
            "mtime": "2024-03-06 21:21",
            "mcontent": "2楼对的就是预设一串编码，然后结合时间戳+编码进行验证码生成，这样即便离线也能使用高级一点的会同时植入多条编码，同时生成多个验证码，你可以刷新替换。"
        }
    ]
}