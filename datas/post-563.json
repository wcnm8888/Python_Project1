{
    "link": "https://bbs.nga.cn/read.php?tid=41647497",
    "title": "在正常情况下，像数据库，消息队列这些中间件要不要部署在k8s中？",
    "post_time": "2024-09-13 10:31",
    "uid": "61917298",
    "content": "本人小厂螺丝钉，最近在自己折腾服务器，用k8s部署了像数据库，消息队列等这些中间件。今天有人和我说，在通常情况下这些是不要部署在k8s中。所以现在有点不知所措，不知道自己瞎折腾的方向对不对了。特来请教，万分感谢。",
    "replies": [
        {
            "mid": "62668493",
            "mtime": "2024-09-13 11:15",
            "mcontent": "我是把中间件之类的都部到了k8s里，包括mongo和redis，数据挂载到了aliyun nfs。mysql直接买了aliyun的rds(出问题了有人背锅，哈哈哈)"
        },
        {
            "mid": "61917298",
            "mtime": "2024-09-13 11:25",
            "mcontent": "OK 兄弟，心里有数了感谢。我这是自己买的物理服务器，在自己练习，公司没有用到k8s，公司也没有什么技术大牛。您这么一说  心里踏实了"
        },
        {
            "mid": "8777681",
            "mtime": "2024-09-13 11:27",
            "mcontent": "如果这些中间件本身的横向扩展能力、高可用能力、运维能力等角度，推荐甚至依赖k8s，那就肯定用；如果中间本身的这些能力不推荐容器化，那就不用另外，容器有毕竟是共享宿主机I/O能力、以及文件句柄数上限等资源的如果有多容器复用宿主机后，可能要突破这些上限的，那当然也不应使用容器化"
        },
        {
            "mid": "61917298",
            "mtime": "2024-09-13 11:33",
            "mcontent": ""
        },
        {
            "mid": "63782286",
            "mtime": "2024-09-13 11:44",
            "mcontent": "你有没有问过这个人，为什么不要部署到k8s呢？感觉可以部署的话，为什么不呢？"
        },
        {
            "mid": "61917298",
            "mtime": "2024-09-13 11:48",
            "mcontent": ""
        },
        {
            "mid": "63782286",
            "mtime": "2024-09-13 12:38",
            "mcontent": "那就不用理他，好好学吧。"
        },
        {
            "mid": "12194861",
            "mtime": "2024-09-13 13:32",
            "mcontent": "Ks8是容器化服务。理论上任何程序都能部署到里面。但是容器化的目的是方便扩展。像数据库这种持久存放数据的部署到里面意义不大。容器一旦出问题，里面的数据就都没了。除非是打包卖系统的场景，一键部署所有。"
        },
        {
            "mid": "61917298",
            "mtime": "2024-09-13 13:37",
            "mcontent": ""
        },
        {
            "mid": "64114905",
            "mtime": "2024-09-14 13:43",
            "mcontent": "如果用量不大，这类服务买云厂商比较合适，这样k8s 本身的运维会做的容易些，否则还要配合很多开源方案实现这些服务在k8s 上的高可用、滚动升级，备份还原。大方向是存算分离，各司其职。小厂没有专业的人就把专业的事交给别人去做。"
        },
        {
            "mid": "21242410",
            "mtime": "2024-09-29 10:58",
            "mcontent": "放有状态的其实应该是考虑到如果不使用类似nfs之类的存储，而是local volume这种，一旦node出问题无法及时恢复吧？"
        },
        {
            "mid": "64114905",
            "mtime": "2024-09-29 23:09",
            "mcontent": "如果是云上环境，块存储在AZ内可以自动重新挂载但是有状态服务的数据可靠性应该由应用自身的副本或者同步机制解决，而不是靠K8S保障"
        }
    ]
}