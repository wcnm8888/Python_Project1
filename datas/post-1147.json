{
    "link": "https://bbs.nga.cn/read.php?tid=39986288",
    "title": "win上如何监控某个程序的网络连接？",
    "post_time": "2024-04-26 18:42",
    "uid": "734189",
    "content": "背景如下:",
    "replies": [
        {
            "mid": "62295674",
            "mtime": "2024-04-26 18:45",
            "mcontent": "tcpview 试试，我用来看客户端到服务器连接地址和端口"
        },
        {
            "mid": "41525142",
            "mtime": "2024-04-26 18:56",
            "mcontent": "对命令行熟悉的话，先找到进程的pid，然后netstat找到pid对应的端口，然后任何抓包软件都可以筛选。"
        },
        {
            "mid": "734189",
            "mtime": "2024-04-26 19:06",
            "mcontent": "感谢楼上两位老哥建议， 受到启发， 我找到了个工具叫LiveTcpUdpWatch， 可以满足我需求(我猜游戏服务不会建立TCP？)"
        },
        {
            "mid": "42252406",
            "mtime": "2024-04-27 08:35",
            "mcontent": "一般v里面会有路由文本配置，找一下。然后程序的tcp/ip信息，去下一个processmonitor，免费任务管理器就行。"
        },
        {
            "mid": "734189",
            "mtime": "2024-04-27 08:50",
            "mcontent": "更新下，以防有类似需求的老哥走我的弯路。通过上面各位老哥提到的和我找到的工具，我拿到了游戏访问的目标ip,但是，除了初始化过程中的一部分固定的(有地址的而非纯ip),其他ip会有随机性切不断变化，我猜可能是负载均衡或者什么东西？没写过游戏纯粹瞎猜。搜了下，如果想只对某个程序做tunnel,有个词叫split tunnel,但是我没找到简单好用的实现方式。只能勤快点手动切换了"
        },
        {
            "mid": "5254815",
            "mtime": "2024-04-27 09:21",
            "mcontent": "Tun 模式有白名单的啊，就和那种东西一样"
        },
        {
            "mid": "734189",
            "mtime": "2024-04-27 09:26",
            "mcontent": ""
        },
        {
            "mid": "60969175",
            "mtime": "2024-04-27 10:03",
            "mcontent": "有个很贵但是很优雅的解决方案，surge for mac"
        },
        {
            "mid": "42252406",
            "mtime": "2024-04-27 12:28",
            "mcontent": "百度whois查询就行。或者，可以把这些ip拿记事本记下来，看看是不是只在这几个固定ip里面跳。因为从登录到状态迁移到游戏主服务器，也有不同ip接口。"
        },
        {
            "mid": "42252406",
            "mtime": "2024-04-27 12:29",
            "mcontent": ""
        },
        {
            "mid": "42937034",
            "mtime": "2024-04-27 22:50",
            "mcontent": "抓包软件wireshark就可以，不过纯粹的抓包分析比较费力，找个全流量抓包分析工具就行。至于访问控制这是系统自带的基础功能，自带防火墙就能完成，可以基于tcpip，或者动态域名，也可以基于会话层应用层控制流量的走向。但你挂梯子导致走代理那个没有办法，代理优先级比策略路由高，得调下优先级"
        },
        {
            "mid": "5254815",
            "mtime": "2024-04-28 11:25",
            "mcontent": "Mac 上有 surge.  win 上有 rule provider 类型，都支持类似的需求。"
        },
        {
            "mid": "64708092",
            "mtime": "2024-04-28 17:59",
            "mcontent": "纯抓包 wireshark 截包fidder Charles bursuite，但看起来都不是很适合。监控 tcpview processmonitor networkmonitor 后两个我用的比较多，可以关联到进程一般来说不是直接ipport ，会有cdn之类，所以只抓ip可能解决不了"
        },
        {
            "mid": "8777681",
            "mtime": "2024-04-29 09:45",
            "mcontent": "这不正是sockscap 之类类似软件的需求场景么"
        },
        {
            "mid": "731907",
            "mtime": "2024-04-29 11:58",
            "mcontent": "就拿魔兽世界举例登录服务器，账号验证是login.wow.com:3724游戏区服s1，游戏中和服务器数据交换，是s1.wow.com:8085一般登录验证过程是TCP协议的多，游戏数据交换UDP协议的多。域名DNS解析是UDP协议。想实现代理的话一般有下面四种技术路线，也就是游戏加速软件所谓的模式1-4：使用LSP技术劫持进程数据包，转发给代理服务器使用基于L2TP协议的VPN技术，转发给代理服务器使用基于PPTP协议的VPN技术，转发给代理服务器安装虚拟网卡，再给系统路由表添加所有游戏相关IP，实现游戏数据包通过虚拟网卡转发给代理服务器因为楼主想使用网卡模式代理，就需要知道所有游戏相关IP，而IP又因为域名负载均衡原因总是变，抓起来太麻烦。所以这里有个简单方法，直接抄游戏加速器的现成IP，不用自己找。楼主你安装个网易UU，使用路由模式加速游戏，然后你看系统路由表，UU已经添加好了所有游戏IP段。你把游戏IP段复制下来，关闭UU。修改游戏IP段的路由指向为你的代理网卡网关，就行了。"
        },
        {
            "mid": "734189",
            "mtime": "2024-04-29 12:59",
            "mcontent": ""
        },
        {
            "mid": "734189",
            "mtime": "2024-04-29 13:00",
            "mcontent": ""
        }
    ]
}